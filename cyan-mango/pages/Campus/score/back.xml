
<view class='page'>
	
	<view hidden='{{hideSyncTip}}' style='color:grey;font-size:70%;margin:10rpx'>24:00后教务系统通道关闭，将无法同步</view>

<!-- 本学期成绩 -->
	<block wx:if="{{!current_term}}">
  	<view class='sum-grade'>
		<view style='flex:1'>{{grade.average_point}}
			<view class='bottom-text'>平均绩点</view>
		</view>
		<view style='flex:1'>{{grade.course_credit}}
			<view class='bottom-text'>总学分</view>
		</view>
	</view>
		<view wx:if="{{grade}}" bindchange='swiperChange' style='height:{{height}}rpx'>
			<view  wx:key="index">
					<view class='sem-cell'>
						<view style='height:250rpx'>
							<view style='color:gray;padding:15rpx;font-size:110%'>{{grade.xnd}}学年 第{{grade.xqd}}学期</view>
							<view class='sem-grade'>
								<view style='flex:1'>{{grade.general_course_credit+grade.electives_credit+grade.compulsory_course_credit}}
									<view class='bottom-text'>已修学分</view>
								</view>

								<view style='flex:1'>{{grade.average_point}}
									<view class='bottom-text'>学期绩点</view>
								</view>

							</view>
						</view>
						<!-- 课程成绩循环 --> 
							<view class='grade-cell' wx:for="{{grade.score}}">
							<view bindtap="showDetail" id="{{index}}">
							
									<view class='son-part part1'>
										<view style='flex:1.5'>{{item.course}}</view>
										<view style='flex:1;color:#18b3eb;'>{{item.grade}}</view>
									</view>

									<view class='son-part part2'>
										<view style='flex:1.5'>学分：{{item.credit}}</view>
										<view style='flex:1'>绩点：{{item.point}}</view>
									</view>
							</view>
							</view>
						</view>
			</view>
		</view>
	</block>

	<!-- 无成绩数据 -->
	<!-- <view wx:if="{{!grade}}">
		<view class="text-center" style='margin:200rpx 0'>
			<view>未查询到当前学期成绩数据</view>
			<view>可能教务系统未录入，请迟点再试！</view>
			<view bindtap="getExamHistory" class="box"> 》》》拉取数据《《《 </view>
		</view>
	</view> -->

	<block wx:if="{{grade}}">
		<view style='color:grey;font-size:70%;margin:20rpx'>成绩数据仅供参考，请以官网为准</view>
	</block>
</view>

  <modal custom="true" show="{{showDetail}}" bind:cancel="cancelModal">
    <swiper bindchange="switchCourse" indicator-dots="{{detail.length>1?true:false}}" current="{{currentIndex}}" style='height:580rpx'>
      <swiper-item wx:for="{{detail}}" wx:key="index">
			<!-- TODO:颜色 -->
        <view class='course' style='background-color:green'>
          <view>{{item.course}}（{{item.course_type}}）</view>
        </view>
        <view style='padding:10rpx'>
          <view class='detail-item solid-top'>
            <view class='key'>总评成绩</view>
            <view class='value'>{{item.grade}}</view>
          </view>
          <view class='detail-item solid-top'>
            <view class='key'>绩点</view>
            <view class='value'>{{item.point}}</view>
          </view>
          <view class='detail-item solid-top'>
            <view class='key'>期末成绩</view>
            <view class='value'>{{item.grade}}</view>
          </view>
          <view class='detail-item solid-top'>
            <view class='key'>平时成绩</view>
            <view class='value'>{{item.usual_grade}}</view>
          </view>
          <view class='detail-item solid' wx:if="{{item.midterm_grade!=''}}">
            <view class='key'>期中考</view>
            <view class='value'>{{item.midterm_grade}}</view>
          </view>
          <view class='detail-item solid-top' wx:if="{{item.credit!=null}}">
            <view class='key'>学分</view>
            <view class='value'>{{item.credit}}</view>
          </view>
					<view class='detail-item solid-top' wx:if="{{item.credit!=null}}">
            <view class='key'>重修课</view>
            <view class='value'>{{item.rebuild_course}}</view>
          </view>
        </view>
      </swiper-item>
    </swiper>
  </modal>
	